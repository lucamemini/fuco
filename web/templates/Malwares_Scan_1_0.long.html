<div class="panel panel-danger" ng-if="!success">
    <div class="panel-heading">
        <strong>{{(artifact.data || artifact.attachment.name) | fang}}</strong>
    </div>
    <div class="panel-body">
        {{content.errorMessage}}
    </div>
</div>

<div>
    
    <div class="panel panel-info">
        <div class="panel-heading">
            <strong>Summary</strong>
        </div>
        <div class="panel-body">
            <dl class="dl-horizontal" ng-if="content.ai_score">
                <dt>AI Score</dt>
                <dd class="wrap">
                    <span ng-if="content.ai_score < 10" class="label label-success">
                        {{content.ai_score || 0}}/100
                    </span>
                    <span ng-if="content.ai_score >= 10 && content.ai_score < 30" class="label label-warning">
                        {{content.ai_score || 0}}/100
                    </span>
                    <span ng-if="content.ai_score > 30" class="label label-danger">
                        {{content.ai_score || 0}}/100
                    </span>
                </dd>
            </dl>
            <dl class="dl-horizontal" ng-if="content.virustotal">
                <dt>VT Score</dt>
                <dd class="wrap">
                    <span ng-if="content.virustotal.positives == 0" class="label label-success">
                        {{content.virustotal.positives}}/{{content.virustotal.total}}
                    </span>
                    <span ng-if="content.virustotal.positives > 0 && content.virustotal.positives < 5" class="label label-warning">
                        {{content.virustotal.positives}}/{{content.virustotal.total}}
                    </span>
                    <span ng-if="content.virustotal.positives >= 5" class="label label-danger">
                        {{content.virustotal.positives}}/{{content.virustotal.total}}
                    </span>
                </dd>
				<dt>VT Scan Date</dt>
				<dd class="wrap">{{content.virustotal.scan_date}}</dd>
            </dl>			
			<dl class="dl-horizontal" ng-if="content.md5">
                <dt>MD5</dt>
                <dd class="wrap">{{content.md5}}</dd>
            </dl>
			<dl class="dl-horizontal" ng-if="content.sha1">
                <dt>SHA-1</dt>
                <dd class="wrap">{{content.sha1}}</dd>
            </dl>
			<dl class="dl-horizontal" ng-if="content.sha256">
                <dt>SHA-256</dt>
                <dd class="wrap">{{content.sha256}}</dd>
            </dl>
			<dl class="dl-horizontal" ng-if="content.ssdeep">
                <dt>SSDEEP</dt>
                <dd class="wrap">{{content.ssdeep}}</dd>
            </dl>
			<dl class="dl-horizontal" ng-if="content.imphash">
                <dt>Imphash</dt>
                <dd class="wrap">{{content.imphash}}</dd>
            </dl>			
			<dl class="dl-horizontal" ng-if="content.filesize">
                <dt>File Size</dt>
                <dd class="wrap">{{content.filesize}} bytes</dd>
            </dl>
            <dl class="dl-horizontal" ng-if="content.filename">
                <dt>File Name</dt>
                <dd class="wrap">{{content.filename.join(', ')}}</dd>
            </dl>
			<dl class="dl-horizontal" ng-if="content.filetype">
                <dt>File Type</dt>
                <dd class="wrap">{{content.filetype}}</dd>
            </dl>
            <dl class="dl-horizontal" ng-if="content.first_seen">
                <dt>Known Date</dt>
                <dd class="wrap">{{content.first_seen}}</dd>
            </dl>
            <dl class="dl-horizontal" ng-if="content.taglist">
                <dt>Categories</dt>
                <dd class="wrap">{{content.taglist.join(', ')}}</dd>
            </dl>
            <dl class="dl-horizontal" ng-if="content.resolutions && content.resolutions.length > 0">
                <dt>Resolutions</dt>
                <dd>
                    <div ng-if="::artifact.dataType === 'domain'">
                        <strong>This domain has been seen to resolve to the following IP addresses.</strong>
                    </div>
                    <div ng-if="::artifact.dataType === 'ip'">
                        <strong>The following domains resolved to the given IP address.</strong>
                    </div>
                    <div ng-repeat="resolution in ::content.resolutions | limitTo:20">
                        {{::resolution.last_resolved | amDateFormat:'DD-MM-YYYY'}}:
                        <span class="text-danger wrap">{{(resolution.ip_address | fang) || (resolution.hostname | fang)}}</span>
                    </div>
                </dd>
            </dl>
            <dl class="dl-horizontal" ng-if="['ip', 'domain', 'hash'].indexOf(artifact.dataType) !== -1">
                <dt>Malwares</dt>
                <dd>
                    <span ng-if="artifact.dataType === 'domain'">
                        <i class="fa fa-search"></i>
                        <a ng-href="https://www.malwares.com/report/host?host={{artifact.data}}" target="_blank">
                            View Full Report</a>
                    </span>
                    <span ng-if="artifact.dataType === 'ip'">
                        <i class="fa fa-search"></i>
                        <a ng-href="https://www.malwares.com/report/ip?ip={{artifact.data}}" target="_blank">
                            View Full Report</a>
                    </span>
                    <span ng-if="artifact.dataType === 'hash'">
                        <i class="fa fa-search"></i>
                        <a ng-href="https://www.malwares.com/report/file?hash={{artifact.data}}" target="_blank">
                            View Full Report</a>
                    </span>
                </dd>
            </dl>
        </div>
    </div>

    <div class="panel panel-info" ng-if="::content.detected_url" ng-init="detected_url_limit = 20">
        <div class="panel-heading">
            <strong>Malicious URL history of this IP</strong>
            <span class="pull-right" ng-show="::content.detected_url.list.length > 20">
                <a href ng-show="detected_url_limit===20" ng-click="detected_url_limit = undefined">Show All ({{::content.detected_url.list.length}})</a>
                <a href ng-show="!detected_url_limit"ng-click="detected_url_limit = 20">Show less</a>
            </span>
        </div>
        <div class="panel-body">
            <table class="table table-hover">
                <tr>
                    <th>Score</th>
                    <th>Scan Date</th>
                    <th>URL</th>
                </tr>
                <tr ng-repeat="url in content.detected_url.list | limitTo:detected_url_limit">
                    <td>
                        <span ng-class="{'text-danger': url.positives > 0}">{{::url.positives}}/{{::url.total}}</span>
                    </td>
                    <td>{{url.date}}</td>
                    <td class="wrap">{{url.url | fang}}</td>
                </tr>
            </table>
        </div>
    </div>

    <div class="panel panel-info" ng-if="content.hostname_history" ng-init="detected_hostname_history_limit=20">
        <div class="panel-heading">
            <strong>Hostname usage history of this IP</strong>
            <span class="pull-right" ng-show="::content.hostname_history.list.length > 20">
                <a href ng-show="detected_hostname_history_limit===20" ng-click="detected_hostname_history_limit = undefined">Show All ({{::content.hostname_history.list.length}})</a>
                <a href ng-show="!detected_hostname_history_limit"ng-click="detected_hostname_history_limit = 20">Show less</a>
            </span>
        </div>
        <div class="panel-body">
            <table class="table table-hover">
                <tr>
                    <th>Hostname</th>
                    <th>Last Check Date</th>
                </tr>
                <tr ng-repeat="hostname in content.hostname_history.list | limitTo:detected_hostname_history_limit">
                    <td>{{hostname.hostname}}</td>
                    <td>{{hostname.date}}</td>
                </tr>
            </table>
        </div>
    </div>

	    <div class="panel panel-info" ng-if="content.detected_downloaded_file" ng-init="detected_downloaded_file_history_limit=20">
        <div class="panel-heading">
            <strong>Malicious sample history downloaded from this IP</strong>
            <span class="pull-right" ng-show="::content.detected_downloaded_file.list.length > 20">
                <a href ng-show="detected_downloaded_file_limit===20" ng-click="detected_downloaded_file_limit = undefined">Show All ({{::content.detected_downloaded_file.list.length}})</a>
                <a href ng-show="!detected_downloaded_file_limit"ng-click="detected_downloaded_file_limit = 20">Show less</a>
            </span>
        </div>
        <div class="panel-body">
            <table class="table table-hover">
                <tr>
                    <th>SHA-256</th>
					<th>VT Score</th>					
                    <th>Known Date</th>
                </tr>
                <tr ng-repeat="malicious_sample_downloaded in content.detected_downloaded_file.list | limitTo:detected_downloaded_file_limit">
                    <td>{{malicious_sample_downloaded.sha256}}</td>
					<td>{{::malicious_sample_donwloaded.positives}}/{{::malicious_sample_downloaded.total}}</td>
                    <td>{{malicious_sample_downloaded.date}}</td>
                </tr>
            </table>
        </div>
    </div>
	
    <div class="panel panel-info" ng-if="content.undetected_downloaded_file" ng-init="undetected_downloaded_file_history_limit=20">
        <div class="panel-heading">
            <strong>Normal sample history downloaded from this IP</strong>
            <span class="pull-right" ng-show="::content.undetected_downloaded_file.list.length > 20">
                <a href ng-show="undetected_downloaded_file_limit===20" ng-click="undetected_downloaded_file_limit = undefined">Show All ({{::content.undetected_downloaded_file.list.length}})</a>
                <a href ng-show="!undetected_downloaded_file_limit"ng-click="undetected_downloaded_file_limit = 20">Show less</a>
            </span>
        </div>
        <div class="panel-body">
            <table class="table table-hover">
                <tr>
                    <th>SHA-256</th>
                    <th>Known Date</th>
                </tr>
                <tr ng-repeat="normal_sample_downloaded in content.undetected_downloaded_file.list | limitTo:undetected_downloaded_file_limit">
                    <td>{{normal_sample_downloaded.sha256}}</td>
                    <td>{{normal_sample_downloaded.date}}</td>
                </tr>
            </table>
        </div>
    </div>

    <div class="panel panel-info" ng-if="content.detected_communicating_file" ng-init="detected_communicating_file_limit=20">
        <div class="panel-heading">
            <strong>Malicious sample history communicated with this IP</strong>
            <span class="pull-right" ng-show="::content.detected_communicating_file.list.length > 20">
                <a href ng-show="detected_communicating_file_limit===20" ng-click="detected_communicating_file_limit = undefined">Show All ({{::content.detected_communicating_file.list.length}})</a>
                <a href ng-show="!detected_communicating_file_limit"ng-click="detected_communicating_file_limit = 20">Show less</a>
            </span>
        </div>
        <div class="panel-body">
            <table class="table table-hover">
                <tr>
                    <th>SHA-256</th>
					<th>VT Score</th>
                    <th>Known Date</th>
                </tr>
                <tr ng-repeat="malicious_sample_communicated in content.detected_communicating_file.list | limitTo:detected_communicating_file_limit">
                    <td>{{malicious_sample_communicated.sha256}}</td>
                    <td>{{::malicious_sample_communicated.positives}}/{{::malicious_sample_communicated.total}}</td>
					<td>{{malicious_sample_communicated.date}}</td>
                </tr>
            </table>
        </div>
    </div>	
	
    <div class="panel panel-info" ng-if="content.undetected_communicating_file" ng-init="undetected_communicating_file_limit=20">
        <div class="panel-heading">
            <strong>Normal sample history communicated with this IP</strong>
            <span class="pull-right" ng-show="::content.undetected_communicating_file.list.length > 20">
                <a href ng-show="undetected_communicating_file_limit===20" ng-click="undetected_communicating_file_limit = undefined">Show All ({{::content.undetected_communicating_file.list.length}})</a>
                <a href ng-show="!undetected_communicating_file_limit"ng-click="undetected_communicating_file_limit = 20">Show less</a>
            </span>
        </div>
        <div class="panel-body">
            <table class="table table-hover">
                <tr>
                    <th>SHA-256</th>
                    <th>Known Date</th>
                </tr>
                <tr ng-repeat="normal_sample_communicated in content.undetected_communicating_file.list | limitTo:undetected_communicating_file_limit">
                    <td>{{normal_sample_communicated.sha256}}</td>
					<td>{{normal_sample_communicated.date}}</td>
                </tr>
            </table>
        </div>
    </div>	
	
	
	   <div class="panel panel-info" ng-if="content.virustotal.scans" ng-init="virustotal_limit=20">
        <div class="panel-heading">
            <strong>URL Analysis Engine Detection Details</strong>
            <span class="pull-right" ng-show="::content.virustotal.scans.length > 20">
                <a href ng-show="virustotal_limit===20" ng-click="virustotal_limit = undefined">Show All ({{::content.virustotal.scans.length}})</a>
                <a href ng-show="!virustotal_limit" ng-click="virustotal_limit = 20">Show less</a>
            </span>
        </div>
        <div class="panel-body">
            <table class="table table-hover">
                <tr>
                    <th>URL Analysis Engine Name</th>
                    <th>Detection State</th>
                </tr>
                <tr ng-repeat="(vt_n, vt_d) in content.virustotal.scans | limitTo:virustotal_limit">
                    <td>{{vt_n}}</td>
                    <td>
                        <span ng-if="vt_d.detected && ( vt_d.result == 'malware site' || vt_d.result == 'malicious site' )" class="label label-danger">
                            {{vt_d.result}}
                        </span>
                        <span ng-if="vt_d.detected && vt_d.result == 'suspicious site'" class="label label-warning">
                            {{vt_d.result}}
                        </span>
                        <span ng-if="!vt_d.detected">
                            <font style="color:green;"><i class="glyphicon glyphicon-ok-sign"/></font>
                        </span>                        
                        <span ng-if="vt_d.detail">
                            <a href="{{vt_d.detail}}" target="_blank" class="btn btn-lg"> <i class="glyphicon glyphicon-list-alt"/></a>
                        </span>
                    </td>
                </tr>
            </table>
        </div>
    </div>  
    
    <div class="panel panel-info" ng-if="content.scans">
        <div class="panel-heading">
            <strong>Scans</strong>
        </div>
        <div class="panel-body">

            <table class="table table-hover">
                <tr>
                    <th>Scanner</th>
                    <th>Detected</th>
                    <th>Result</th>
                    <th>Details</th>
                    <th>Update</th>
                    <th>Version</th>
                </tr>
                <tr ng-init="result.unrated = (result.result === 'unrated site')" ng-repeat="(scanner, result) in content.scans">
                    <td>
                        <strong>{{scanner}}</strong>
                    </td>
                    <td>
                        <i ng-class="{'text-danger fa fa-bug': result.detected, 'text-success fa fa-check-circle': !result.detected && !result.unrated, 'text-info fa fa-question-circle': result.unrated}"></i>
                    </td>
                    <td ng-class="{'text-info': result.unrated, 'text-danger': result.detected, 'text-success': !result.detected && !result.unrated}" class="wrap">{{result.result}}</td>
                    <td>
                        <a ng-href="{{result.detail}}" ng-if="result.detail" target="_blank">
                            <i class="fa fa-search"></i>
                            View details</a>
                    </td>
                    <td>{{result.update}}</td>
                    <td>{{result.version}}</td>
                </tr>
            </table>
        </div>
    </div>

</div>